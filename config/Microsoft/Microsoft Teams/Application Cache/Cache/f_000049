(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[51],{"348426a60b7cb4dbeb31":function(e,t,i){"use strict";var n=i("11e808f62b4fe6e70870"),a=i("8d96f6a4786b316c0d53"),s=i("5f0dbee501b8046e840c"),r=i("2118c0654cdae82c146d"),o=i("94a755535d135f12850c"),c=i("56e93fab5efcffbf24fb"),l=i("e0ae79cd8630f9b39623"),u=function(){function e(e){var t=this;this.telemetrySettings=null,this.disableColumnBlocker=!1,this.fixedColumnRules={},this.blockedColumnRules={},this.columnBlockingRules={},this.wildCardMergedTables={},this.wildCardTableEmpty=!0,this.updateColumnBlockingSettings=function(e){if(e){if(t.telemetrySettings=e,t.disableColumnBlocker=e.disableColumnBlocker||!1,t.disableColumnBlocker)return t.columnBlockingRules={},t.wildCardMergedTables={},void(t.wildCardTableEmpty=!0);var i={};e.blockedColumnRules&&(i=e.blockedColumnRules),t.blockedColumnRules=i;var n={};e.fixedColumnRules&&(n=e.fixedColumnRules),t.fixedColumnRules=n,t.generateRuleSet()}},e.getObservable(c.a.Telemetry).subscribe(this.updateColumnBlockingSettings),this.telemetrySettings=e.get(c.a.Telemetry),this.updateColumnBlockingSettings(this.telemetrySettings)}return e.prototype.applyColumnBlockingRules=function(e,t,i,n){try{if(this.wildCardTableEmpty||this.wildCardMergedTables[e]||(this.columnBlockingRules[e]=Object(o.merge)(this.columnBlockingRules[e],this.columnBlockingRules["*"]),this.wildCardMergedTables[e]=!0),Object(o.isEmpty)(this.columnBlockingRules[e]))return;Object(o.isEmpty)(this.columnBlockingRules[e][t])?Object(o.isEmpty)(this.columnBlockingRules[e]["*"])||this.blockEventPropertyColumn(this.columnBlockingRules[e]["*"],i,n):this.blockEventPropertyColumn(this.columnBlockingRules[e][t],i,n)}catch(e){return void i.setProperty("diagBlockedColumns",Object(l.a)({parseFailed:!0}))}},e.prototype.blockEventPropertyColumn=function(e,t,i){var n=t.properties,a={},s=null==i?void 0:i.packedData;Object(o.forEach)(e,function(e,t){Object(o.isEmpty)(n[t])||(n[t].value="",a[t]=e),s&&s.forEach(function(i){i[t]&&(i[t]=void 0,a[t]=e)})}),Object(o.isEmpty)(a)||t.setProperty("diagBlockedColumns",Object(l.a)(a))},e.prototype.generateRuleSet=function(){var e=this;try{this.columnBlockingRules={},this.wildCardMergedTables={};var t=this.blockedColumnRules["*"],i=this.fixedColumnRules["*"];Object(o.forEach)(this.blockedColumnRules,function(n,a){if(!Object(o.isEmpty)(n)){Object(o.isEmpty)(t)||"*"===a||(n=Object(o.merge)(n,t)),!Object(o.isEmpty)(e.fixedColumnRules)&&!Object(o.isEmpty)(e.fixedColumnRules[a])&&!Object(o.isEmpty)(i)&&"*"!==a&&(e.fixedColumnRules[a]=Object(o.merge)(e.fixedColumnRules[a],i)),e.columnBlockingRules[a]={};var s={};Object(o.isEmpty)(n["*"])||e.mergeBlockedColumnsRulesForAllEventType(n,a,s),Object(o.isEmpty)(s)||(e.columnBlockingRules[a]["*"]=s),e.mergeBlockedColumnsRulesForEveryEventType(n,a,s),Object(o.isEmpty)(e.columnBlockingRules[a])?delete e.columnBlockingRules[a]:e.wildCardMergedTables[a]=!0}}),this.wildCardTableEmpty=Object(o.isEmpty)(this.columnBlockingRules["*"])}catch(e){return}},e.prototype.mergeBlockedColumnsRulesForAllEventType=function(e,t,i){var n=this;Object(o.forEach)(e["*"],function(e,a){e>(n.fixedColumnRules[t]&&n.fixedColumnRules[t]["*"]&&n.fixedColumnRules[t]["*"][a]||0)&&(i[a]=e)})},e.prototype.mergeBlockedColumnsRulesForEveryEventType=function(e,t,i){var n=this;Object(o.forEach)(e,function(e,a){"*"!==a&&(Object(o.isEmpty)(n.fixedColumnRules[t])||Object(o.isEmpty)(n.fixedColumnRules[t][a])?n.columnBlockingRules[t][a]=Object(o.merge)(e,i):(n.columnBlockingRules[t][a]={},Object(o.forEach)(e,function(e,i){e>(n.fixedColumnRules[t][a][i]||0)&&(n.columnBlockingRules[t][a][i]=e)}),n.columnBlockingRules[t][a]=Object(o.merge)(n.columnBlockingRules[t][a],i),Object(o.isEmpty)(n.columnBlockingRules[t][a])&&delete n.columnBlockingRules[t][a]))})},e}();i.d(t,"a",function(){return g});var p=function(){function e(){var e=this;this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=function(){return e.telemetryProvider.flush()},this.telemetryProvider=Object(n.b)(),Object(a.a)(function(){e.initialized=!1,e.eventDecoratorCallbacks=[]})}return Object.defineProperty(e.prototype,"sessionId",{get:function(){return this.telemetryProvider.sessionId},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t,i){this.initialized||(this.consoleLogger=t,this.consoleLogger.debug("TelemetrySender initialized."),r.a.getInstance().initialize(i),this.columnSuppressionService=new u(i),this.telemetryProvider.initialize(e,this.consoleLogger,this.columnSuppressionService),this._tablePostfix=e.documentInfo.tablePostfix||"",this.initialized=!0)},e.getInstance=function(){return this.telemetrySender||(this.telemetrySender=new e),this.telemetrySender},e.prototype.registerEventDecorator=function(e){this.eventDecoratorCallbacks.push(e)},e.prototype.sendTelemetry=function(e,t,i,a,o){if(void 0===i&&(i={}),this.initialized){t=t.replace(/\-/g,"_").toLowerCase();var c=(""+s.a[e]+this._tablePostfix).toLowerCase(),l=e===s.a.Scenario?i["Scenario.Status"]:e===s.a.Http?i.resultCode:void 0,u=r.a.getInstance().getSampleRate(c,t,l);if(u!==r.b){this.decorateEvent(t,i);var p=this.telemetryProvider.createEvent(c,t,i,a,o);p.setProperty("sampleRate",u);var g=e===s.a.UserBI?n.a.userBi:n.a.default;this.telemetryProvider.logEvent(g,p)}}},e.prototype.decorateEvent=function(e,t){this.eventDecoratorCallbacks.forEach(function(i){return i(e,t)})},e}();function g(e,t,i,n,a){p.getInstance().sendTelemetry(e,t,i,n,a)}},"5f0dbee501b8046e840c":function(e,t,i){"use strict";var n;i.d(t,"a",function(){return n}),function(e){e[e.Perf=0]="Perf",e[e.Scenario=1]="Scenario",e[e.Logging=2]="Logging",e[e.Tracking=3]="Tracking",e[e.Heartbeat=4]="Heartbeat",e[e.Http=5]="Http",e[e.UserBI=6]="UserBI"}(n||(n={}))},"9c09065bd76afcf0a959":function(e,t,i){"use strict";i.r(t);var n,a=i("275976081ce1abf67779"),s=i("298834ef555136219449"),r=i("c4e5d556b9dfef6082b0"),o=i("66ed9b0e2e19f957591e"),c=i("2fb8223a0230e17c2ea9"),l=i("9b08f2e86f0e0f9ec656"),u=i("a689a10faf924dde39cc"),p=i("68ad756829a3e387be42"),g=i("4240efd871ae15138fcf"),d=i("3a3917c057079b816e70"),h=i("56e93fab5efcffbf24fb"),m=i("cf694d8109b055738d55"),f=i("d3bb8f02f954659262db"),b=i("64328bb588b46459132d"),S=12e4,v={"cdl-request":!0},y=i("f9a6412761c79a080418"),C=i("348426a60b7cb4dbeb31"),E=i("e4015b2ea28f962ed7da"),T=i("5f0dbee501b8046e840c"),k=i("94a755535d135f12850c"),P="Scenario.Step",w=function(){function e(e,t,i,n,a,s,r,o,c,l,u,p,g){var d,h=this;void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===u&&(u=!1),void 0===p&&(p=E.a.Expanded),this._id=e,this._name=t,this._eventData=i,this.scenarioFactory=n,this.logger=a,this.timeout=s,this.callback=r,this.memoryAnalyzer=o,this.enableDiagnostics=c,this.markStepsInTrace=l,this.showAllConsoleLogs=u,this.scenarioMode=p,this.reportActivity=g,this.steps=[],this.stepsEx=[],this._sequence=0,this.__stepsPerfInfo__=[],this.getTotalPauseDuration=function(){return h.pauseInfo.totalTime},this._currentStep=E.c.Unknown,this._timestamps=[],this._isHoisted=!1,this.active=!0,this.pauseInfo={reason:"",startTime:0,totalTime:0};var m=0;i.overrideTimestamp?(m=i.overrideTimestamp-Date.now(),i.overrideTimestamp=void 0):i.offsetCurrentTimeInMs&&(m=-i.offsetCurrentTimeInMs,i.offsetCurrentTimeInMs=void 0),this._absoluteStartTime=Date.now()+m,this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp()+m,this.memoryDataInitial=null===(d=this.memoryAnalyzer)||void 0===d?void 0:d.snapshotMemoryUsage()}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absoluteStartTime",{get:function(){return this._absoluteStartTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this.scenarioFactory.timestamp()-this.relativeTimestamp},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutMs",{get:function(){return this.timeout},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventData",{get:function(){return this._eventData},set:function(e){this._eventData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return this._timestamps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentStep",{get:function(){return this._currentStep},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return!!this.pauseInfo.startTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHoisted",{get:function(){return this._isHoisted},set:function(e){this._isHoisted=e},enumerable:!1,configurable:!0}),e.prototype.appendEventData=function(e){this.eventData=Object(b.__assign)(Object(b.__assign)({},this.eventData),e)},e.prototype.markAggregateStart=function(e){this.active?(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[e]||(this.aggregateStepStartTime[e]=performance.now())):this.logger.debug("Scenario '"+this.name+"' set to inactive")},e.prototype.markAggregateStop=function(e){this.active&&this.aggregateStepStartTime[e]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[e]||(this.aggregateStepTotalTime[e]=0),this.aggregateStepTotalTime[e]+=performance.now()-this.aggregateStepStartTime[e],this.aggregateStepStartTime[e]=void 0)},e.prototype.pause=function(e,t){if(this.active&&!this.isPaused){this._currentStep!==E.c.Unknown&&this.mark(this._currentStep);var i=e.reason,n=Object(b.__rest)(e,["reason"]);this.mark(E.c.Pause,Object(b.__assign)({pauseReason:i},n),void 0,t),this.pauseInfo=Object(b.__assign)(Object(b.__assign)({},this.pauseInfo),{reason:i,startTime:Date.now()})}},e.prototype.resume=function(e,t){if(this.active&&this.isPaused){var i=this.pauseInfo.startTime?Date.now()-this.pauseInfo.startTime:0;this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+i,this.mark(E.c.Resume,Object(b.__assign)(Object(b.__assign)({},e),{pauseReason:this.pauseInfo.reason}),void 0,t),this.pauseInfo.reason="",this.pauseInfo.startTime=0}},e.prototype.stop=function(e,t,i){var n=this;void 0===t&&(t="success"),this._currentStep!==E.c.Unknown&&this.mark(this._currentStep,void 0,t,i),this.aggregateStepTotalTime&&(Object(k.each)(Object.keys(this.aggregateStepTotalTime),function(e){var t=parseInt(n.aggregateStepTotalTime[e].toString(),10);n.mark(e,{stepDelta:t},void 0,i)}),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),this.createMark(E.c.Stop,e,t,!0,i).then(function(){n.active&&(n.active=!1),n.callback&&n.callback(t),n.scenarioFactory.clearScenario(n)})},e.prototype.fail=function(e,t){this.stop(e,"failure",t)},e.prototype.cancel=function(e,t){this.stop(e,"abandoned",t)},e.prototype.incomplete=function(e,t){this.stop(e,"incomplete",t)},e.prototype.mark=function(e,t,i,n){void 0===i&&(i="success"),this.createMark(e,t,i,!1,n),this._currentStep=E.c.Unknown},e.prototype.startStep=function(e){this._currentStep!==E.c.Unknown&&e!==this._currentStep&&this.mark(this._currentStep),this._currentStep=e},e.prototype.prepareAndSendTelemetry=function(e,t){var i=this;this.eventData&&this.eventData!==e&&(e=Object(b.__assign)(Object(b.__assign)({},this.eventData),e)),e.InstanceId=this.id,e=this.getEventDataWithComutedValues(e),this.enableDiagnostics&&Object(y.a)().pushTelemetryEvent(T.a[T.a.Scenario],e),e["Scenario.Mode"]=this.scenarioMode;var n,a=e[P];if(a!==E.c.Start&&(this.scenarioMode!==E.a.Expanded&&(this.packStandardAttributes(e),a===E.c.Stop&&(e["Scenario.Steps"]=JSON.stringify(this.steps),n={columnName:"Scenario.StepsEx",packedData:this.stepsEx})),this.scenarioMode!==E.a.Packed||a===E.c.Stop)){var s=function(){return Object(C.a)(T.a.Scenario,i.name,e,t,n)};a!==E.c.Stop?s():Promise.all([this.updateEventDataMemory(e)]).then(function(){s()}).catch(function(){s()})}this.logScenarioPerf(e)},e.prototype.logScenarioPerf=function(e){if(this.showAllConsoleLogs){var t=e[P],i=t===E.c.Start?"[step]("+this._sequence+")"+t:t===E.c.Stop?"[step]("+this._sequence+")"+t+" ("+e.stepDelta+"ms/"+e.delta+"ms)":"[step]("+this._sequence+")"+t+" ("+e.stepDelta+"ms)";this.logger&&this.logger.log("[Scenario]"+this.name+" "+i),this.__stepsPerfInfo__.push({name:t,stepDelta:e.stepDelta,delta:e.delta})}},e.prototype.updateEventDataMemory=function(e){var t=this;return this.memoryAnalyzer?this.memoryAnalyzer.snapshotMemoryUsageAsync().then(function(i){var n,a,s;i&&(i.jsHeapStatistics&&(e.jsUsedHeapSize=i.jsHeapStatistics.used_heap_size,e.jsUsedHeapSizeDelta=(null===(n=t.memoryDataInitial)||void 0===n?void 0:n.jsHeapStatistics)?t.memoryDataInitial.jsHeapStatistics.used_heap_size-i.jsHeapStatistics.used_heap_size:void 0),i.processMemoryInfo&&(e.workingSet=i.processMemoryInfo.workingSetSize,e.workingSetDelta=(null===(a=t.memoryDataInitial)||void 0===a?void 0:a.processMemoryInfo)?i.processMemoryInfo.workingSetSize-t.memoryDataInitial.processMemoryInfo.workingSetSize:void 0,e.privateBytes=i.processMemoryInfo.privateBytes,e.privateBytesDelta=(null===(s=t.memoryDataInitial)||void 0===s?void 0:s.processMemoryInfo)?i.processMemoryInfo.privateBytes-t.memoryDataInitial.processMemoryInfo.privateBytes:void 0))}):Promise.resolve()},e.prototype.getEventDataWithComutedValues=function(e){var t,i=this.intervalTimestamp;Object(k.isNumber)(e.overrideTimestamp)?(t=this.relativeTimestamp+e.overrideTimestamp-this._absoluteStartTime,e.overrideTimestamp=void 0):e.offsetCurrentTimeInMs?(t=this.scenarioFactory.timestamp()-e.offsetCurrentTimeInMs,e.offsetCurrentTimeInMs=void 0):t=e[P]===E.c.Start?this.relativeTimestamp:this.scenarioFactory.timestamp(),this._timestamps.push(t),this.intervalTimestamp=t;var n=Object(k.isNumber)(e.stepDelta)?e.stepDelta:t-i,a=Object(k.isNumber)(e.delta)?e.delta:t-this.relativeTimestamp-this.getTotalPauseDuration(),s=Object(k.isNumber)(e.elapsed)?e.elapsed:t,r=Object(k.isNumber)(e.elapsedSinceCoreInit)?e.elapsedSinceCoreInit:this.scenarioFactory.timestamp({isFromCoreInit:!0}),o=this._sequence,c=!!this.scenarioFactory.findScenario(E.b.WindowLaunchTime);return Object(b.__assign)(Object(b.__assign)({},e),{isInEst:c,stepDelta:n,delta:a,elapsed:s,elapsedSinceCoreInit:r,sequence:o})},e.prototype.packStandardAttributes=function(e){var t={};t["Scenario.Status"]=e["Scenario.Status"],t[P]=e[P],t.stepDelta=e.stepDelta,t.elapsed=e.elapsed,t.delta=e.delta,t.sequence=e.sequence,this.steps.push(t)},e.prototype.getMonitoringDataOverride=function(e){var t=e;return this.name!==E.b.WindowLaunchTime&&this.name!==E.b.ExperienceReady||(t=e?Object(k.cloneDeep)(e):{scenarioPriority:"P0",data:[]}).data.push({key:"App",value:this.eventData.contentSlotApp}),t},e.prototype.createMark=function(e,t,i,n,a){return void 0===t&&(t={}),Object(b.__awaiter)(this,void 0,void 0,function(){var s,r,o,c;return Object(b.__generator)(this,function(l){return e&&this.active?(e!==E.c.Stop&&e!==E.c.Start&&this.scenarioMode!==E.a.Expanded&&void 0!==t&&this.stepsEx.push(Object(k.cloneDeep)(t)),t["Scenario.Status"]=i,t[P]=e,t["Scenario.Name"]=this.name,s=this.getMonitoringDataOverride(a),performance&&performance.mark&&performance.measure&&!v.hasOwnProperty(this.name)&&(r=t[P]+" "+t["Scenario.Name"]+"-"+this.id,performance.mark(r),t[P]===E.c.Stop&&(o="start "+t["Scenario.Name"]+"-"+this.id,0===(performance.getEntriesByName(o,"mark")||[]).length&&(o="navigationStart"),c=this.clientName?" ("+this.clientName+")":"",performance.measure(""+t["Scenario.Name"]+c,o,r)),this.markStepsInTrace&&(this.previousMark&&performance.measure(t["Scenario.Name"]+" ["+this.previousMark+" <=> "+t[P]+"]",this.previousMark+" "+t["Scenario.Name"]+"-"+this.id,t[P]+" "+t["Scenario.Name"]+"-"+this.id),this.previousMark=t[P])),this.prepareAndSendTelemetry(t,s),this.active=this.active&&!n,this.reportActivity&&this.reportActivity(t),this._sequence+=1,[2]):[2]})})},e}(),O=i("3e9c7e5351d86134f5f6"),D=function(){function e(e){this._name=e}return Object.defineProperty(e.prototype,"id",{get:function(){return"noop"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutMs",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventData",{get:function(){return{}},set:function(e){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return[]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isHoisted",{get:function(){return!1},set:function(e){},enumerable:!1,configurable:!0}),e.prototype.appendEventData=function(e){},e.prototype.pause=function(e){},e.prototype.resume=function(e){},e.prototype.cancel=function(e){},e.prototype.mark=function(e,t,i){},e.prototype.startStep=function(e){},e.prototype.stop=function(e,t){},e.prototype.fail=function(e){},e.prototype.incomplete=function(e){},e.prototype.markAggregateStart=function(e){},e.prototype.markAggregateStop=function(e){},e.prototype.getTotalPauseDuration=function(){return 0},e}(),M=function(){function e(e,t,i,n,a,s,r){var o=this;void 0===t&&(t=0),void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===a&&(a=!1),this.appStartTimestamp=t,this.enableDiagnostics=i,this.markStepsInTrace=n,this.showAllConsoleLogs=a,this.memoryAnalyzer=r,this.activeScenarios=[],this.scenarioTimeoutMs=S,this.markStep=function(e,t,i){var n=o.findScenario(e);n&&n.mark(t,i&&i.eventData,i&&i.status,i&&i.monitoringData)},this.startStep=function(e,t){var i=o.findScenario(e);i&&i.startStep(t)},this.timestamp=function(){return Date.now()-o.appStartTimestamp},this.setTimeoutCallback=(null==s?void 0:s.setTimeout)||setTimeout,this.clearTimeoutCallback=(null==s?void 0:s.clearTimeout)||clearTimeout,this.logger=e.newLogger("Telemetry"),this.logger.debug("Initialized ScenarioFactory")}return e.prototype.newScenario=function(e,t){var i=this.createScenarioWithoutStarting(e,t);return i.mark("start",void 0,void 0,t&&t.monitoringData),i},e.prototype.createScenarioWithoutStarting=function(e,t){if(void 0===t&&(t={}),0===this.appStartTimestamp)return new D(e);var i=void 0===t.captureMemoryUsage||t.captureMemoryUsage,n={};isNaN(t.startTime)||null===t.startTime||(n.overrideTimestamp=t.startTime);var a=Object(O.v4)(),s=new w(a,e,n,this,this.logger,t.timeoutMs||this.scenarioTimeoutMs,t.callback,i?this.memoryAnalyzer:void 0,this.enableDiagnostics,this.markStepsInTrace,this.showAllConsoleLogs),r=this.setupScenarioTimeout(s);return this.activeScenarios.push({scenario:s,timeoutId:r}),s},e.prototype.cancelExistingAndCreateScenario=function(e,t,i,n,a){var s=this.findScenario(e);if(s){var r=[{reason:t}];s.cancel({errors:JSON.stringify(r)})}return s=this.newScenario(e,{timeoutMs:i,callback:n,monitoringData:a})},e.prototype.stopScenarioIfActive=function(e,t,i,n){var a=this.findScenario(e);a&&a.stop(t,i,n)},e.prototype.findScenario=function(e){if(!e)return null;var t=Object(k.findLast)(this.activeScenarios,function(t){return t&&t.scenario.name===e||t.scenario.clientId===e})||null;return t?t.scenario:null},e.prototype.findScenarioByNameAndId=function(e,t){var i=Object(k.findLast)(this.activeScenarios,function(i){return i.scenario.name===e&&i.scenario.clientId===t})||null;return i?i.scenario:null},e.prototype.clearScenario=function(e){var t=Object(k.findIndex)(this.activeScenarios,function(t){return t.scenario===e});if(t>-1){var i=this.activeScenarios.splice(t,1)[0];this.clearTimeoutCallback(i.timeoutId)}},e.prototype.setContext=function(){},e.prototype.setupScenarioTimeout=function(e,t){var i=e.timeoutMs;return this.setTimeoutCallback(function(){e.stop(e.eventData,"timeout",t)},i)},e}(),I=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),A=function(e){function t(t){var i=e.call(this,t)||this;i.enableChannelFilesTabDocLibBreadcrumb=!1,i.enableMountPointRenderOption=!1,i.newKeyIdentifierFlag=!1,i.changeTheme=function(e){i.setState({currentTheme:e})},i.changeUserPref=function(e){i.setState({currentUserPref:e})};var n=d.a.getAppState().currentTheme;i.state={currentTheme:n,currentUserPref:t.getUserFileOpenPreference&&t.getUserFileOpenPreference()||o.d.Teams},i.scenario=g.a.findScenario(o.I.getTeamFilesV2),i.serviceName=o.J.teams;var a=t.analyticsService,s=t.clientDatabaseProvider,r=t.settingsService;if(i.analyticsService=a||new p.a,s&&u.a.initialize(s),r){var c=new m.a(r);l.a.initialize(c,new M(g.a));var b=c.get(h.a.Telemetry).telemetryServer;i.ariaCollectorUrl=b;var S=c.get(h.a.Metadata).ring;i.userRing=null==S?void 0:S.id;var v=new f.a(r);i.filesScenarioTimeoutInSeconds=v.filesScenarioTimeoutInSeconds,i.newKeyIdentifierFlag=v.enableNewLocalStoreKeyIdentifier,i.clientType=v.clientType,i.enableChannelFilesTabDocLibBreadcrumb=v.enableChannelFilesTabDocLibBreadcrumb||!1,i.enableMountPointRenderOption=v.enableMountPointRenderOption||!1}return i}return I(t,e),t.prototype.render=function(){return a.createElement(s.b,{currentTheme:Object(c.b)(this.state.currentTheme),analyticsService:this.analyticsService},a.createElement(s.a,{compileIntoAngular:this.props.compileIntoAngular},a.createElement(r.b,{analyticsService:this.analyticsService},this.getSharePointLayout())))},t.prototype.getSharePointLayout=function(){return a.createElement(s.e,{onCopyLink:this.props.onCopyLink,addCloudStorage:this.props.addCloudStorage,addSPCloudStorageWithPromise:this.props.addSPCloudStorageWithPromise,deleteCloudStorage:this.props.deleteCloudStorage,siteInfo:this.props.siteInfo,threadId:this.props.threadId,teamThreadId:this.props.teamThreadId,isChannelOwner:this.props.isChannelOwner,acquireToken:this.props.acquireToken,downloadFiles:this.props.downloadFiles,scenario:this.scenario,loggingPrefix:o.I.channelFilesPrefix,pinToTabAction:this.props.pinToTabAction,changeDefaultAppAction:this.props.changeDefaultAppAction,moveFiles:this.props.moveFiles,copyFiles:this.props.copyFiles,serviceName:this.serviceName,currentTheme:Object(c.b)(this.state.currentTheme),getChannelCloudStorageFolders:this.props.getChannelCloudStorageFolders,isFreemium:this.props.isFreemium,enableFilesCopyShareLink:this.props.enableFilesCopyShareLink,enableNStarViewerExpInMainWindow:this.props.enableNStarViewerExpInMainWindow,provisionSpecialDocumentLibraries:this.props.provisionSpecialDocumentLibraries,enableChannelFilesPrefetchBridge:this.props.enableChannelFilesPrefetchBridge,filesScenarioTimeoutInSeconds:this.filesScenarioTimeoutInSeconds,renderedWindowsAhead:this.props.renderedWindowsAhead,renderedWindowsBehind:this.props.renderedWindowsBehind,createFolderAndRefreshSiteUrl:this.props.createFolderAndRefreshSiteUrl,enablePromoteChannelFolder:this.props.enablePromoteChannelFolder,newLocalStorageKeyIdentifierFlag:this.newKeyIdentifierFlag,userRing:this.userRing,clientVersion:this.props.clientVersion,isDownloadBlocked:this.props.isDownloadBlocked,isEditMetadataEnabled:this.props.isEditMetadataEnabled,enableDesktopUsePluginess:this.props.enableDesktopUsePluginess,enableWindowOpenForProtocolHandlerInvocation:this.props.enableWindowOpenForProtocolHandlerInvocation,enableWebAsDefaultFileOpenPreference:this.props.enableWebAsDefaultFileOpenPreference,handleFileOpenPreferenceUpdate:this.props.handleFileOpenPreferenceUpdate,currentUserPref:this.state.currentUserPref,isFileOpenExperimentEnabled:!!this.props.isFileOpenExperimentEnabled,clientType:this.clientType,isGeneralChannel:this.props.isGeneralChannel||!1,enableChannelFilesTabDocLibBreadcrumb:this.enableChannelFilesTabDocLibBreadcrumb,enableMountPointRenderOption:this.enableMountPointRenderOption,ariaCollectorUrl:this.ariaCollectorUrl})},t}(a.Component);i.d(t,"ChannelFilesRoot",function(){return A})},cf694d8109b055738d55:function(e,t,i){"use strict";var n=i("64328bb588b46459132d"),a=i("56e93fab5efcffbf24fb"),s=i("e88a8106e72c3f2e7fd4"),r=i("2cb027059b5fbe2cc8a6"),o=i("640a68d4e52093ac8444"),c=i("6871d1ea20c032a12e30"),l=i("06c58f420a0677aad466"),u=i("d3bb8f02f954659262db"),p=i("604f694397cd1f47d3c5"),g={allowBroadcastSchedulingPolicy:"allowBroadcastSchedulingPolicy",allowChannelMeetingSchedulingPolicy:"allowChannelMeetingSchedulingPolicy",allowEngagementReportPolicy:"allowEngagementReportPolicy",allowPrivateMeetingSchedulingPolicy:"allowPrivateMeetingSchedulingPolicy",calendarRESTEnabledAPIs:"calendarRESTEnabledAPIs",debounceSchedulingFormPeoplePickerGuestSearchinMillis:"debounceSchedulingFormPeoplePickerGuestSearchinMillis",disableFormOptimization:"disableFormOptimization",enableAppsGalleryinMeetingChat:"enableAppsGalleryinMeetingChat",enableCalendarAttachments:"enableCalendarAttachments",enableCalendarCategories:"enableCalendarCategories",enableCalendarCopyLink:"enableCalendarCopyLink",enableCalendarDialogBridge:"enableCalendarDialogBridge",enableCalendarEventGroupChiclet:"enableCalendarEventGroupChiclet",enableCalendarEventsBackgroundSync:"enableCalendarEventsBackgroundSync",enableCalendarJoinButtonWithIcon:"enableCalendarJoinButtonWithIcon",enableCalendarNstarExtensibilityTabs:"enableCalendarNstarExtensibilityTabs",enableCalendarSchedulingFormNewPeoplePill:"enableCalendarSchedulingFormNewPeoplePill",enableCalendarSchedulingFormPreReleaseFeatures:"enableCalendarSchedulingFormPreReleaseFeatures",enableCalendarShareLinkDialog:"enableCalendarShareLinkDialog",enableCalendarShareLinkDialogPostMeetingCreation:"enableCalendarShareLinkDialogPostMeetingCreation",enableMeetNowSharePanelInCalendar:"enableMeetNowSharePanelInCalendar",enableCalendarTenantCheckForPeopleSearch:"enableCalendarTenantCheckForPeopleSearch",enableCalendarV2ApiService:"enableCalendarV2ApiService",enableCalendarV2ApiServiceEnterprise:"enableCalendarV2ApiServiceEnterprise",enableCalendarV2EventForwarding:"enableCalendarV2EventForwarding",enableCalendarV2ShowAs:"enableCalendarV2ShowAs",enableCallTranscriptPostMeetingSpeakerAttribution:"enableCallTranscriptPostMeetingSpeakerAttribution",enableCallTranscriptPostMeetingSpeakerAttributionEdit:"enableCallTranscriptPostMeetingSpeakerAttributionEdit",enableEngagementReportPolicyCheck:"enableEngagementReportPolicyCheck",enableFreemiumMeetingInviteWithDate:"enableFreemiumMeetingInviteWithDate",enableGetCalendarEventsFromRest:"enableGetCalendarEventsFromRest",enableInlineMeetingOptions:"enableInlineMeetingOptions",enableMeetingArtifacts:"enableMeetingArtifacts",enableMeetingInfoDropdown:"enableMeetingInfoDropdown",enableMeetingOptionsButton:"enableMeetingOptionsButton",enableMultiWindowCalendarSchedulingForm:"enableMultiWindowCalendarSchedulingForm",enableMultiWindowCalendarSchedulingFormViewAndEdit:"enableMultiWindowCalendarSchedulingFormViewAndEdit",enableOnlineAppointment:"enableOnlineAppointment",enableQuickCreateForFreemiumCalendar:"enableQuickCreateForFreemiumCalendar",enableRecordingPostMeeting:"enableRecordingPostMeeting",engagementReportPolicyTestHookOverride:"engagementReportPolicyTestHookOverride",enableEngagementReportPolicyTestHook:"enableEngagementReportPolicyTestHook",enableRequireRegistrationInMeetingSchedulingForm:"enableRequireRegistrationInMeetingSchedulingForm",enableRockfallCalendarMeetingSchedulingEnhancements:"enableRockfallCalendarMeetingSchedulingEnhancements",enableSpeedyMeetings:"enableSpeedyMeetings",enableSchedulingFormTrackingViewSummary:"enableSchedulingFormTrackingViewSummary",enableSchedulingWebinars:"enableSchedulingWebinars",isConsumerWindow:"isConsumerWindow",meetingOptionsUrl:"meetingOptionsUrl",enableCalendarV2PreReleaseFeatures:"enableCalendarV2PreReleaseFeatures",calendarEventsPollIntervalInMs:"calendarEventsPollIntervalInMs",enableCalendarEventsPrefetchPrevNextWeek:"enableCalendarEventsPrefetchPrevNextWeek",enableGroupEventsInGeneralChannelCalendar:"enableGroupEventsInGeneralChannelCalendar",enableCalendarV2MeetingPrep:"enableCalendarV2MeetingPrep",enableFreemiumAgendaView:"enableFreemiumAgendaView",enableFreemiumCalendarShareViaOutlook:"enableFreemiumCalendarShareViaOutlook",enableFreemiumCalendarShareViaGoogle:"enableFreemiumCalendarShareViaGoogle",freemiumCalendarShareViaOutlookAllowedDomains:"freemiumCalendarShareViaOutlookAllowedDomains",freemiumCalendarShareViaGoogleAllowedDomains:"freemiumCalendarShareViaGoogleAllowedDomains",noOfAttendeesForShowingTrackingViewSummary:"noOfAttendeesForShowingTrackingViewSummary",isMeetingOnenoteAgendaEnabled:"isMeetingOnenoteAgendaEnabled"},d=i("94a755535d135f12850c");i.d(t,"a",function(){return h});var h=function(){function e(e,t){var i;this.settingsService=e,this.policySettingsStoreService=t,this.settingsCache={},this.itProSettings={isBroadcastSchedulingAllowed:!1,isPrivateMeetingSchedulingAllowed:!0,isChannelMeetingSchedulingAllowed:!0,allowEngagementReport:a.b.AllowEngagementReport.Disabled},this.userPropertiesSettings={},this.settingsByCategoryMap=new Map([[a.a.Metadata,{getSettings:this.getMetadataSettings.bind(this),namespace:s.b}],[a.a.Test,{getSettings:this.getTestSettings.bind(this),namespace:s.b}],[a.a.Auth,{getSettings:this.getAuthSettings.bind(this),namespace:s.b}],[a.a.Telemetry,{getSettings:this.getTelemetrySettings.bind(this),namespace:s.b}],[a.a.Host,{getSettings:this.getHostSettings.bind(this),namespace:s.b}],[a.a.Localization,{getSettings:this.getLocalizationSettings.bind(this),namespace:s.b}],[a.a.Calendar,{getSettings:this.getCalendarSettings.bind(this),namespace:s.b}],[a.a.Platform,{getSettings:this.getPlatformSettings.bind(this),namespace:s.b}],[a.a.ChatList,{getSettings:this.getChatListSettings.bind(this),namespace:s.b}],[a.a.Shortcuts,{getSettings:this.getShortcutsSettings.bind(this),namespace:s.b}],[a.a.WebinarRegistration,{getSettings:this.getWebinarRegistrationSettings.bind(this),namespace:s.b}]]),this.userPropertiesSettings=null!==(i=null==t?void 0:t.getUserPropertiesSettings())&&void 0!==i?i:{}}return e.prototype.get=function(e){return this.getSubject(e).value},e.prototype.getObservable=function(e){return this.getSubject(e).asObservable()},e.prototype.getSubject=function(e){var t=this;if(this.settingsCache[e])return this.settingsCache[e];var i=this.getSettingsForCategory(e),n=i.subscriptionNamespace,s=i.settings,r=new l.a(s||{});this.settingsCache[e]=r;e===a.a.Calendar&&this.policySettingsStoreService&&this.getCalendarPolicySettings(r);var o=new c.a("adapter-"+e+"-"+n,function(){var i=t.getSettingsForCategory(e).settings;r.next(i)},n);return this.settingsService.addListener(o),r},e.prototype.getSettingsForCategory=function(e){var t=this.settingsByCategoryMap.get(e),i=e.toString().toLowerCase(),n=t?t.getSettings():this.settingsService.getSettingsForNamespace(i)||{};return{subscriptionNamespace:t?t.namespace:i,settings:n}},e.prototype.getMetadataSettings=function(){var e,t=new u.a(this.settingsService).ring,i=this.settingsService.get(p.a.EnvironmentType,p.a.EnvironmentKey);return t&&(e={id:t.id||"general",friendlyName:t.friendlyName,shortName:t.shortName}),{ring:e,eTag:null==t?void 0:t.eTag,environment:i}},e.prototype.getTestSettings=function(){return{isRunningGlassjar:this.settingsService.getBoolean("isRunningGlassjar"),mtAuthResourceOverride:this.settingsService.getString("skypeAuthEndpointAddressV2"),mtOverrideBaseUrl:this.settingsService.getString("mtOverrideBaseURL")}},e.prototype.getAuthSettings=function(){var e=this.settingsService.get("authConstants");if(e){var t=e.skypeAuthEndpointAddressV2,i=Object(d.isArray)(e.resources)&&e.resources.length>0&&e.resources[0];return{authzEndpointUrl:t,mtResource:i,authzResource:this.settingsService.get("isConsumerWindow")?e.consumerAuthzResource:i}}return{}},e.prototype.getTelemetrySettings=function(){var e,t,i,n,a,s,o=this.settingsService.get("loggingConstants"),c=this.isScenarioMemorySnapshotEnabled();o&&(i=o.telemetryserver,n=null===(e=o.appTokens)||void 0===e?void 0:e.default,a=null===(t=o.appTokens)||void 0===t?void 0:t.userBi,s=!!o.silent&&o.silent,this.settingsService.get(p.a.EnvironmentType,p.a.EnvironmentKey)!==r.a.Prod&&o.appTokens&&o.appTokens.test&&(n=o.appTokens.test,a=o.appTokens.test));return{defaultToken:n,isSilent:s,telemetryServer:i,userBiToken:a,isScenarioMemorySnapshotEnabled:c}},e.prototype.getHostSettings=function(){return{keyboardLayoutLanguage:this.settingsService.getString("keyboardLayoutLanguage")}},e.prototype.getLocalizationSettings=function(){return{enableLocalizedKeyboardShortcuts:this.settingsService.getBoolean("enableLocalizedKeyboardShortcuts")}},e.prototype.getCalendarSettings=function(){var e=this,t=Object(d.mapValues)(g,function(t){return e.settingsService.get(t)}),i=this.itProSettings,a={allowChannelMeetingSchedulingPolicy:i.isChannelMeetingSchedulingAllowed,allowPrivateMeetingSchedulingPolicy:i.isPrivateMeetingSchedulingAllowed,allowBroadcastSchedulingPolicy:i.isBroadcastSchedulingAllowed,allowEngagementReportPolicy:i.allowEngagementReport};return Object(n.__assign)(Object(n.__assign)(Object(n.__assign)({},t),a),this.userPropertiesSettings)},e.prototype.getCalendarPolicySettings=function(e){var t=this,i=this.policySettingsStoreService.isChannelMeetingSchedulingAllowed(),n=this.policySettingsStoreService.isPrivateMeetingSchedulingAllowed(),s=this.policySettingsStoreService.getBroadcastPolicySettings(),r=this.policySettingsStoreService.allowEngagementReport();s.then(function(i){t.itProSettings.isBroadcastSchedulingAllowed=i.allowBroadcastScheduling;var n=t.getCalendarSettings();e.next(n)}).catch(function(){}),Promise.all([i,n,r]).then(function(i){var n=i[0],a=i[1],s=i[2];t.itProSettings.isChannelMeetingSchedulingAllowed=n,t.itProSettings.isPrivateMeetingSchedulingAllowed=a,t.itProSettings.allowEngagementReport=s;var r=t.getCalendarSettings();e.next(r)}).catch(function(){t.itProSettings.isChannelMeetingSchedulingAllowed=!1,t.itProSettings.isPrivateMeetingSchedulingAllowed=!1,t.itProSettings.allowEngagementReport=a.b.AllowEngagementReport.Disabled;var i=t.getCalendarSettings();e.next(i)}),this.updateUserPropertiesSettings(e)},e.prototype.getPlatformSettings=function(){return{sessionId:this.settingsService.getString(p.a.SessionIdKey,p.a.PlatformKey)||this.settingsService.getString(p.a.SessionIdKey,p.a.CookiesKey)}},e.prototype.getChatListSettings=function(){return{enableBuddyList:this.settingsService.getBoolean(p.a.EnableBuddyList),hideSelectedChatLeftRailTypingIndicator:this.settingsService.getBoolean(p.a.HideSelectedChatLeftRailTypingIndicator)}},e.prototype.getShortcutsSettings=function(){var e=this.settingsService.get(p.a.ClientType,p.a.PlatformKey)===o.b.Desktop,t=this.settingsService.get(p.a.RingKey);return{applyDesktopKeymappingStrategy:e,enableDevShortcuts:!(!t||t.isPublic)}},e.prototype.isScenarioMemorySnapshotEnabled=function(){return this.settingsService.get(p.a.ClientType,p.a.PlatformKey)===o.b.Desktop&&this.settingsService.getBoolean(p.a.EnableMemoryDumpApi,p.a.DesktopSettingsKey)},e.prototype.getWebinarRegistrationSettings=function(){var e=this.settingsService.get("webinarSettings");return{webinarServiceEndpoint:e.serviceEndpoint,webinarServiceResource:e.serviceResource}},e.prototype.updateUserPropertiesSettings=function(e){var t,i=this;null===(t=this.policySettingsStoreService)||void 0===t||t.waitAndGetUserPropertiesSettings().then(function(t){var a=t.autodiscoverSettings,s=t.isOnCloud,r=i.getCalendarSettings();Object(d.isEqual)(a,r.autodiscoverSettings)&&s===r.isOnCloud||(i.userPropertiesSettings={autodiscoverSettings:a,isOnCloud:s},e.next(Object(n.__assign)(Object(n.__assign)({},r),i.userPropertiesSettings)))}).catch(function(){})},e}()},f9a6412761c79a080418:function(e,t,i){"use strict";var n,a=i("64328bb588b46459132d"),s=i("56e93fab5efcffbf24fb"),r=i("e88a8106e72c3f2e7fd4"),o=i("2a5dd11255f151c25fd3"),c=i("e4015b2ea28f962ed7da"),l=function(){function e(t){this.maxQueueLength=t,this.diagnosticEvents=[],this.queueCapacity=this.maxQueueLength?this.maxQueueLength:e.QUEUE_CAPACITY}return e.prototype.setQueueCapacity=function(e){e<1||this.queueCapacity===e||(this.queueCapacity=e,this.diagnosticEvents.length>e&&(this.diagnosticEvents=this.diagnosticEvents.slice(this.diagnosticEvents.length-e)))},e.prototype.getEvents=function(){return this.diagnosticEvents},e.prototype.enqueueEvent=function(e){this.diagnosticEvents.length<this.queueCapacity?this.diagnosticEvents.push(e):(this.dequeueEvent(),this.diagnosticEvents.push(e))},e.prototype.enqueueEvents=function(e){var t=this;e&&e.length>0&&e.forEach(function(e){t.enqueueEvent(e)})},e.prototype.flush=function(){this.diagnosticEvents=[]},e.prototype.dequeueEvent=function(){return this.diagnosticEvents.shift()},e.QUEUE_CAPACITY=1e3,e}(),u=i("4044e44e608d1baef794"),p=i("e0ae79cd8630f9b39623"),g=i("4df2f88bb138194c8ced"),d=function(){function e(t,i,n,s){var r=this;this.opener=t,this.setTimeout=i,this.clearTimeout=n,this.diagnosticsEventsBuffer=[],this.flush=function(){if(r.diagnosticsEventsBuffer.length>0)try{r.opener.postMessage(g.a.ActivityEvent,{action:"er:rendererDiagnosticsEvents",data:Object(a.__spreadArrays)(r.diagnosticsEventsBuffer)})}catch(e){console.error("DiagnosticsBackupService failed to send a message")}r.reset()},this.backupTimeoutMs=s&&s>0?s:e.DefaultBackupTimeoutMs,this.reset()}return e.prototype.pushDiagnosticsEvent=function(t){t&&(this.diagnosticsEventsBuffer.push(this.stringifyEvent(t)),this.diagnosticsEventsBuffer.length===e.BufferCapacity&&this.flush(),!this.backupTimer&&this.diagnosticsEventsBuffer.length>0&&this.startTimer())},e.prototype.dispose=function(){this.flush()},e.prototype.reset=function(){this.diagnosticsEventsBuffer.length=0,this.stopTimer()},e.prototype.stopTimer=function(){this.backupTimer&&(this.clearTimeout(this.backupTimer),this.backupTimer=void 0)},e.prototype.startTimer=function(){this.backupTimer=this.setTimeout(this.flush,this.backupTimeoutMs)},e.prototype.stringifyEvent=function(e){return Object(p.b)("{0} {1}\t{2}\r\n",[e.timeStamp,e.levelName.slice(0,3),e.message])},e.BufferCapacity=50,e.DefaultBackupTimeoutMs=100,e}(),h=i("94a755535d135f12850c");i.d(t,"a",function(){return f});var m=function(){function e(e){var t=this;this.diagnosticsInstances=new Map,this.diagnosticsBackupEnabled=!1,this.telemetryEvents=new Map,this.diagnosticsEvents=new l,this.scriptStepWhiteList=new Set([c.c.DownloadScripts,c.c.DownloadMainJs]),this.eventWhiteList=new Set([c.b.AppStart,c.b.ChatSendMessage,c.b.RenderChatList,c.b.RenderComposeChat,c.b.RenderShareForm,c.b.SubmitShareForm]),this.environmentDependencies=e,this.storageKey="persistedDiagnostics",this.previousSessionLogsStorageKey="tmp.previousSessionLogs",this.loadPersistedDiagnostics(!0),this.diagnosticsBackupService=void 0,e.addEventListener&&e.addEventListener("unload",function(){t.persistDiagnosticsAsPreviousSessionLogs()})}return e.prototype.updateSettings=function(e){var t=e.get(s.a.Diagnostics),i=t.enableDiagnosticsBackup,n=t.diagnosticsBackupSyncCycleMs,a=t.diagnosticsEventQueueMaxSize;this.setDiagnosticsBackupEnabled(!!i,n||void 0),Object(h.isNumber)(a)&&this.diagnosticsEvents.setQueueCapacity(a)},e.prototype.pushTelemetryEvent=function(t,i){if(this.eventWhiteList.has(i.name)){var n=i&&i.step||"",a=i&&i.elapsed||0;if(this.scriptStepWhiteList.has(n)){var s=e.extractTimeValue(i.stepDelta);this.telemetryEvents.set(n,{delta:s,name:n,telemetryType:t,step:n,elapsed:a})}else{s=e.extractTimeValue(i&&i.delta);this.telemetryEvents.set(i.name,{delta:s,name:i.name,step:n,telemetryType:t,elapsed:a})}}},e.prototype.getTelemetryEvents=function(){return Array.from(this.telemetryEvents.values())},e.prototype.pushDiagnosticsEvent=function(t,i){i.length>e.MAX_MESSAGE_SIZE&&(i=i.substring(0,e.MAX_MESSAGE_SIZE)+e.longMessageEndingPattern);var n={message:i=Object(p.d)(i),level:t,levelName:r.g[t],timeStamp:new Date};this.diagnosticsEvents.enqueueEvent(n),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.pushDiagnosticsEvent(n)},e.prototype.getDiagnosticsEvents=function(e){var t=e&&Math.floor(e/(1+this.diagnosticsInstances.size)),i=[];try{i=this.getDiagnosticsInstancesEvents(t)||[]}catch(e){this.pushDiagnosticsEvent(r.g.Error,"Failed to fetch logs from diagnostic instances: "+e)}var n=[];try{if(n=this.diagnosticsEvents.getEvents()||[],e){var a=e-i.length;a>0&&a<n.length&&(n=n.slice(n.length-a))}}catch(e){this.pushDiagnosticsEvent(r.g.Error,"Failed to fetch diagnostic logs: "+e)}return n=n.reverse(),this.mergeSortedLogs(n,i)},e.prototype.getCurrentSettingsSnapshot=function(e){var t=this;return e?e.getDebugService().then(function(e){return null==e?void 0:e.getSettings()}).then(function(e){if(!e||0===e.length)return"";var i=e.reduce(function(e,t){var i;if(!t.value)return e;e[t.category]=e[t.category]||{},e[t.category][t.key]={};var n=!1;return null===(i=t.providers)||void 0===i||i.forEach(function(i){e[t.category][t.key][i.shortName]=i.value,Object(h.isEqual)(t.value,i.value)||(n=!0)}),n&&t.providers&&t.providers.length>1&&(e[t.category][t.key].value=t.value),e},{});try{return JSON.stringify(i)}catch(e){return t.pushDiagnosticsEvent(r.g.Error,"Diagnostics: Failed stringify settings snapshot: "+e),Object(p.c)(i)}}).catch(function(e){return t.pushDiagnosticsEvent(r.g.Error,"Diagnostics: Failed to get settings snapshot: "+e),""}):Promise.resolve("")},e.prototype.flush=function(){this.diagnosticsEvents.flush(),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.flush()},e.prototype.persistDiagnostics=function(e){this.pushDiagnosticsEvent(r.g.Warn,"Persisting diagnostic events for next load. Key: "+this.storageKey),this.diagnosticsBackupEnabled&&this.diagnosticsBackupService&&this.diagnosticsBackupService.flush(),this.environmentDependencies.localStorage.setItem(this.storageKey,JSON.stringify(this.getDiagnosticsEvents(e)))},e.prototype.loadPersistedDiagnostics=function(e){void 0===e&&(e=!0);var t=this.environmentDependencies.localStorage,i=t.getItem(this.storageKey);if(i){var n=void 0;try{n=JSON.parse(i),Array.isArray(n)&&n.length>0&&this.diagnosticsEvents.enqueueEvents(n),e&&t.removeItem(this.storageKey)}catch(e){this.pushDiagnosticsEvent(r.g.Error,"Failed to load persisted logs from store with error: "+e),t.removeItem(this.storageKey)}}},e.prototype.registerDiagnosticsInstance=function(e,t){this.diagnosticsInstances.set(e,t)},e.prototype.unregisterDiagnosticsInstance=function(e){this.diagnosticsInstances.delete(e)},e.prototype.setDiagnosticsBackupEnabled=function(e,t){void 0===e&&(e=!1),this.diagnosticsBackupEnabled=e,e?!this.diagnosticsBackupService&&this.environmentDependencies.opener&&this.environmentDependencies.setTimeout&&this.environmentDependencies.clearTimeout&&(this.diagnosticsBackupService=new d(this.environmentDependencies.opener,this.environmentDependencies.setTimeout,this.environmentDependencies.clearTimeout,t)):this.diagnosticsBackupService&&(this.diagnosticsBackupService.dispose(),this.diagnosticsBackupService=void 0)},e.prototype.getDiagnosticsInstancesEvents=function(e){var t,i=this,n=Array.from(this.diagnosticsInstances.keys());return!n||n.length<1?[]:n.reduce(function(n,a){if(!(t=i.diagnosticsInstances.get(a)))return n;try{var s=t.getDiagnosticsEvents()||[];return s=Object(h.orderBy)(s,["timeStamp"],["desc"]),e&&e<s.length&&(s=s.slice(0,e)),i.mergeSortedLogs(n,s)}catch(e){return i.pushDiagnosticsEvent(r.g.Error,"Error in collecting diagnostics events from "+a+": "+e),n}},[])},e.extractTimeValue=function(e){return Math.round(parseFloat(e||"0"))},e.prototype.mergeSortedLogs=function(e,t){return(null==e?void 0:e.length)?(null==t?void 0:t.length)?Object(a.__spreadArrays)(e,t).sort(function(e,t){return e.timeStamp>t.timeStamp?-1:e.timeStamp<t.timeStamp?1:0}):e:(null==t?void 0:t.length)?t:[]},e.prototype.persistDiagnosticsAsPreviousSessionLogs=function(){var e=this.getDiagnosticsEvents().reverse(),t=this.formatEvents(e);this.environmentDependencies.localStorage.setItem(this.previousSessionLogsStorageKey,t)},e.prototype.formatEvents=function(e){if(0===e.length)return"";var t="";return e.forEach(function(e){var i=e.timeStamp.toISOString(),n=e.levelName.substring(0,3);t+=i+" "+n+"\t"+e.message+"\r\n"}),Object(p.d)(t)},e.MAX_MESSAGE_SIZE=512,e.longMessageEndingPattern="...",e}(),f=function(){if(!n){var e=void 0;try{e=Object(u.a)()}catch(i){e={getHostedWindowContext:function(){return{panelContext:o.a.worker,startReason:o.b.userInitiated}},localStorage:{getItem:function(e){var i=t.get(e);return void 0===i?null:i},clear:function(){return t.clear()},key:function(e){return Array.from(t.keys())[e]},length:(t=new Map).size,removeItem:function(e){return t.delete(e)},setItem:function(e,i){return t.set(e,i)}}}}n=new m(e)}var t;return n}}}]);