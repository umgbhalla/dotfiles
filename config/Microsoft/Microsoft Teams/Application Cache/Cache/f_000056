(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[41],{"615dbc455b25e563c17c":function(e,t,n){"use strict";var i={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},o=n("94a755535d135f12850c"),r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationUsers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filter"}},type:{kind:"NamedType",name:{kind:"Name",value:"AuthenticationUserFilter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"filter"},value:{kind:"Variable",name:{kind:"Name",value:"filter"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isAuthenticated"}},{kind:"Field",name:{kind:"Name",value:"profile"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"upn"}},{kind:"Field",name:{kind:"Name",value:"puid"}}]}}]}}]}}]},s=n("682ca5ea0252efc642e4"),u=n("3525ad72f86c96c13479");n.d(t,"a",function(){return l});var l=function(e){return{acquireToken:function(t){return e.query({query:i,variables:{resource:t},fetchPolicy:"network-only"}).then(function(e){var t,n=e.data;return{token:null===(t=null==n?void 0:n.authenticationToken)||void 0===t?void 0:t.token}})},acquireTokenWithOptions:function(t,n){return d(e,t,n).then(function(e){var t,n=e.data;return{token:null===(t=null==n?void 0:n.authenticationToken)||void 0===t?void 0:t.token}}).catch(function(e){return Promise.reject(c(e)||e)})},getUser:function(){return e.query({query:r,variables:{filter:{isAuthenticated:!0}}}).then(function(e){var t=e.data,n=e.errors,i=null==t?void 0:t.authenticationUsers;if(!n&&i&&0!==i.length){var a=i[0].profile;return{profile:{oid:a.objectId,tid:a.tenantId,upn:a.upn}}}})}}},d=function(e,t,n){return e.query({query:a,variables:{resource:t,acquireTokenOptions:{claim:void 0,silent:n}},fetchPolicy:"network-only"})},c=function(e){if(f(e)){var t=Object(s.b)(e);return Object(u.d)(t,"innerError",void 0)}return null},f=function(e){return!!e&&!!Object(o.get)(e,"graphQLErrors")}},"7a94afd70fa704798b8b":function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e.iframe="iframe",e.webview="webview"}(i||(i={}))},"87d08a9dabb24a93ef74":function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return r});var i,a,o,r;!function(e){e.web="web",e.desktop="desktop",e.rigel="rigel"}(i||(i={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel"}(a||(a={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(o||(o={})),function(e){e.card="card",e.deepLink="deepLink",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.platformAppView="platformAppView",e.sidePanel="sidePanel"}(r||(r={}))},c521adff8f71ad960064:function(e,t,n){"use strict";var i,a=n("64328bb588b46459132d"),o=n("275976081ce1abf67779"),r={teamSitePath:"teamSitePath",teamSiteDomain:"teamSiteDomain",glassjarBaseUrl:"glassjarBaseUrl"},s="{teamSiteDomain}",u="{teamSitePath}",l="{glassjarBaseUrl}",d={initialize:"initialize",getContext:"getContext",navigateCrossDomain:"navigateCrossDomain",loadingCallback:"loadingCallback",tokenRetrievalCallback:"tokenRetrievalCallback",shareDeepLink:"shareDeepLink",openFilePreview:"openFilePreview",executeDeepLink:"executeDeepLink",getTabInstances:"getTabInstances",getMruTabInstances:"getMruTabInstances",getUserJoinedTeams:"getUserJoinedTeams",getChatMembers:"getChatMembers",toggleIncomingClientAudio:"toggleIncomingClientAudio",getIncomingClientAudioState:"getIncomingClientAudioState",authentication:{getAuthToken:"authentication.getAuthToken",getUser:"authentication.getUser",allowWindowOpen:"authentication.allowWindowOpen",authenticate:"authentication.authenticate",authenticateSuccess:"authentication.authenticate.success",authenticateFailure:"authentication.authenticate.failure"},tasks:{startTask:"tasks.startTask",updateTask:"tasks.updateTask",completeTask:"tasks.completeTask",submitTask:"tasks.submitTask"},conversations:{openConversation:"conversations.openConversation",closeConversation:"conversations.closeConversation"},closeConversation:"closeConversation",startConversation:"startConversation",appInitialization:{appLoaded:"appInitialization.appLoaded",success:"appInitialization.success",failure:"appInitialization.failure"},settings:{setValidityState:"settings.setValidityState",setSettings:"settings.setSettings",saveSettings:"settings.save",removeSettings:"settings.remove",getSettings:"settings.getSettings",save:{success:"settings.save.success",failure:"settings.save.failure"},remove:{success:"settings.remove.success",failure:"settings.remove.failure"}}};!function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(i||(i={}));var c,f={resourceDomainParameter:"{resourceDomain}",validResourcePattern:"^((https|api)://{resourceDomain})"},p=["com.example.microsoftteamstabs.test","e65961b5-7174-44a2-bcac-afd6084d20bf","b58eb5fd-50e3-4ebd-9c1c-8f26e98d5749","db5e5970-212f-477f-a3fc-2227dc7782bf","bb82879b-d5fd-4ee0-af31-ab46da16f71a","2965d9af-530f-425f-806b-94c93c76328f","0001ca17-5f4a-47a3-912f-97aaa1b6fd76"];!function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(c||(c={}));var h=function(e){var t=e.sdkHost,n=e.contentUrl,i=e.frameContext,r=e.appDefinition,s=e.createWebview,u=e.title,l=o.useRef(null);return o.useEffect(function(){Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,s().then(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,t.setFrameAndLoadOrigin(l.current,n,r)];case 1:return e.sent(),[2]}})})})];case 1:return e.sent(),[2]}})})},[s,t,l,n,i,r]),o.createElement(v,{webviewRef:l,title:u})},v=function(e){var t=e.webviewRef,n=e.title;return o.createElement("webview",{ref:t,allowpopups:"true",style:{height:"100%",width:"100%",border:0,flex:1},"data-tid":"app-host-webview",title:n})},m=function(e){var t=e.sdkHost,n=e.contentUrl,i=e.frameContext,r=e.appDefinition,s=e.title,u=o.useRef(null);return o.useEffect(function(){Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,t.setFrameAndLoadOrigin(u.current,n,r)];case 1:return e.sent(),[2]}})})},[t,u,n,i,r]),o.createElement("iframe",{"data-tid":"app-host-iframe",ref:u,style:Object(a.__assign)({},{height:"100%",width:"100%",border:0,flex:1}),sandbox:"allow-forms allow-popups allow-popups-to-escape-sandbox allow-pointer-lock allow-scripts allow-same-origin allow-modals",title:s})},g=n("94a755535d135f12850c"),b=n("7a94afd70fa704798b8b");n("bf92262120ebdf79ce6a");var k,w=function(e){return new URL(e).href},O=function(e){return e&&new URL(e).hostname},T=function(e,t,n){return void 0!==t&&void 0!==e&&function(e,t){if(-1!==e.indexOf("local.teams.office.com"))return!0;for(var n=w(e),i=0,a=Object(g.uniqBy)(t,function(e){return e.toLowerCase()});i<a.length;i++){for(var o="",r=a[i].split("."),s=0;s<r.length;s++)o+=(s>0?"[.]":"")+r[s].replace("*","[^/^.]+");var u=new RegExp("^https://"+o+"((/|\\?).*)?$","i");if(e.match(u)||n.match(u))return!0}return!1}(D(t,n),y(e,n))},y=function(e,t){var n=e.validDomains?Object(g.cloneDeep)(e.validDomains):[];return e.galleryTabs&&n.push.apply(n,Object(g.map)(e.galleryTabs,function(e){return O(D(e.configurationUrl,t))})),e.staticTabs&&n.push.apply(n,Object(g.map)(e.staticTabs,function(e){return e.contentUrl?O(D(e.contentUrl,t)):null})),Object(g.remove)(n,function(e){return!e}),Object(g.uniqBy)(n,function(e){return e.toLowerCase()})},A=function(e){return e&&-1!==p.indexOf(e.toLowerCase())},S=function(e,t){return A(e)||!Object(g.isEmpty)(t)},C=function(e,t,n,i){var a;if(!n||n.isFullTrustApp||A(n.appId))return Promise.resolve(t);if(null===(a=null==n?void 0:n.webApplicationInfo)||void 0===a?void 0:a.resource){var o=R(n,i);return o&&M(o,e)?Promise.resolve([o]):Promise.reject("App resource defined in manifest and iframe origin do not match")}return Promise.reject("App webApplicationInfo or resource not defined in manifest")},D=function(e,t){if(t){if(t.glassjarBaseUrl&&e.includes(l)){var n=new RegExp(l,"g");e=e.replace(n,t.glassjarBaseUrl)}if(t.teamSiteDomain&&e.includes(s)){var i=new RegExp(s,"g");e=e.replace(i,t.teamSiteDomain)}if(t.teamSitePath&&e.includes(u)){i=new RegExp(u,"g");e=e.replace(i,t.teamSitePath)}return e}return e},R=function(e,t){var n,i;return(null===(n=e.webApplicationInfo)||void 0===n?void 0:n.resource)&&D(null===(i=e.webApplicationInfo)||void 0===i?void 0:i.resource,t)},M=function(e,t){if(e&&t){if(e===t)return!0;var n=O(t),i=f.validResourcePattern.replace(f.resourceDomainParameter,n);return new RegExp(i,"i").test(e)}return!1},N=n("87d08a9dabb24a93ef74"),E=function(){function e(e){this.listeners={},this.element=e}return e.prototype.addListener=function(e,t){this.element&&(this.removeListener(e),this.element.addEventListener(e,t),this.listeners[e]=t)},e.prototype.removeListener=function(e){this.element&&this.listeners[e]&&(this.element.removeEventListener(e,this.listeners[e]),delete this.listeners[e])},e.prototype.removeAllListeners=function(){for(var e=0,t=Object.keys(this.listeners);e<t.length;e++){var n=t[e];this.removeListener(n)}},e}();!function(e){e.InvalidAuthUrl="InvalidAuthUrl",e.CancelledByUser="CancelledByUser",e.UnsupportedFrameContext="UnsupportedFrameContext",e.AppDefinitionUnavailable="AppDefinitionUnavailable",e.Other="Other"}(k||(k={}));var U=function(){function e(e,t,n,i,a,o,r){var s=this;if(this.hostWindow=e,this.hostClientType=t,this.doneHandler=i,this.appDefinition=a,this.appContext=o,this.authenticationService=r,this.authHandlers={},this.initialized=!1,this.initialize=function(){return s.initialized=!0,[N.a.authentication,s.hostClientType]},this.handleAuthenticateSuccess=function(e,t){s.initialized&&e&&(s.closeWindow(),s.stopAuthWindowMonitor(),s.doneHandler(!0,t))},this.handleAuthenticateFailure=function(e,t){s.initialized&&e&&(s.closeWindow(),s.stopAuthWindowMonitor(),s.doneHandler(!1,t,k.Other))},this.removeMessageHandler=function(e){delete s.authHandlers[e]},this.onAuthMessageReceived=function(e){if(s.authWindow&&s.authWindow===e.source){var t=e.origin;t!==s.authOrigin&&T(s.appDefinition,t)&&(s.authOrigin=e.origin),s.authOrigin===t&&s.handleMessage(e)}},this.setupAuthMessageHandlers=function(){s.addMessageHandler(d.initialize,s.initialize),s.addMessageHandler(d.authentication.authenticateSuccess,s.handleAuthenticateSuccess),s.addMessageHandler(d.authentication.authenticateFailure,s.handleAuthenticateFailure),s.appContext&&s.authenticationService&&s.addMessageHandler(d.getContext,s.getContext(s.hostClientType,s.appContext,s.authenticationService))},T(a,n)){var u=this.hostWindow.opener.globalWindow;this.authWindow=u.open(n,"appAuthWindow",void 0),this.authWindow&&(this.globalWindowEventListener=new E(u),this.globalWindowEventListener.addListener("message",this.onAuthMessageReceived),this.startAuthWindowMonitor(),this.setupAuthMessageHandlers())}else i(!1,"Auth url is not valid",k.InvalidAuthUrl)}return e.prototype.isWindowOpen=function(){return!!this.authWindow&&!this.authWindow.closed},e.prototype.closeWindow=function(){var e;this.globalWindowEventListener&&this.globalWindowEventListener.removeListener("message"),null===(e=this.authWindow)||void 0===e||e.close()},e.prototype.addMessageHandler=function(e,t){this.authHandlers[e]=t},e.prototype.sendResponseMessage=function(e,t){if(this.authOrigin){var n={id:e,args:t,origin:this.authOrigin};this.postMessage(n)}},e.prototype.sendRequestMessage=function(e,t){if(this.authOrigin){var n={func:e,args:t};this.postMessage(n)}},e.prototype.startAuthWindowMonitor=function(){var e=this;this.stopAuthWindowMonitor(),this.authWindowMonitor=this.hostWindow.setInterval(function(){e.authWindowInterval()},100)},e.prototype.authWindowInterval=function(){this.isWindowOpen()?this.sendRequestMessage("ping"):(this.doneHandler(!1,"CancelledByUser",k.CancelledByUser),this.stopAuthWindowMonitor())},e.prototype.stopAuthWindowMonitor=function(){this.authWindowMonitor&&(this.hostWindow.clearInterval(this.authWindowMonitor),this.authWindowMonitor=void 0)},e.prototype.handleMessage=function(e){var t=this,n=e.data,i=this.authHandlers[n.func];if(i){var a=n.args;(a=n.args&&Array.isArray(n.args)?Object(g.cloneDeep)(n.args):[]).unshift(e);var o=i.apply(this,a);if(o){var r=function(e){t.processHandlerResultHelper(n,e)};"object"==typeof o&&"then"in o&&"function"==typeof o.then?o.then(r):r(o)}}},e.prototype.processHandlerResultHelper=function(e,t){var n=Array.isArray(t)?t:[t];this.sendResponseMessage(e.id,n)},e.prototype.postMessage=function(e){var t;this.authOrigin&&(null===(t=this.authWindow)||void 0===t||t.postMessage(e,this.authOrigin))},e.prototype.getContext=function(e,t,n){return function(){return null==n?void 0:n.getUser().then(function(n){var i,o,r,s,u;return Object(a.__assign)({hostClientType:e,loginHint:(null===(i=null==n?void 0:n.profile)||void 0===i?void 0:i.upn)||"",tid:(null===(o=null==n?void 0:n.profile)||void 0===o?void 0:o.tid)||"",upn:(null===(r=null==n?void 0:n.profile)||void 0===r?void 0:r.upn)||"",userObjectId:(null===(s=null==n?void 0:n.profile)||void 0===s?void 0:s.oid)||"",userPrincipalName:(null===(u=null==n?void 0:n.profile)||void 0===u?void 0:u.upn)||""},t)})}},e}(),I=function(){function e(e,t,n,i){var o=this;this.hostWindow=e,this.hostClientType=t,this.frameContext=n,this.telemetryService=i,this.handlers={},this.initialized=!1,this.removeMessageHandler=function(e){delete o.handlers[e]},this.initializeAuthenticationContext=function(e){var t;o.contextPromise=null===(t=o.authenticationService)||void 0===t?void 0:t.getUser().then(function(t){var n,i,r,s,u;return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},o.getDefaultContext()),{loginHint:(null===(n=null==t?void 0:t.profile)||void 0===n?void 0:n.upn)||"",tid:(null===(i=null==t?void 0:t.profile)||void 0===i?void 0:i.tid)||"",upn:(null===(r=null==t?void 0:t.profile)||void 0===r?void 0:r.upn)||"",userObjectId:(null===(s=null==t?void 0:t.profile)||void 0===s?void 0:s.oid)||"",userPrincipalName:(null===(u=null==t?void 0:t.profile)||void 0===u?void 0:u.upn)||""}),e)})},this.initialize=function(e){return o.initialized=!0,[o.getFrameContext(),o.hostClientType]},this.getContext=function(){var e,t,n=null===(e=o.telemetryService)||void 0===e?void 0:e.createScenario("getContext",null===(t=o.appDefinition)||void 0===t?void 0:t.appId);try{return o.isInitialized()&&o.contextPromise?(null==n||n.stop(),o.contextPromise):(null==n||n.fail("SDK context is not initialized"),Promise.reject("SDK context is not initialized"))}catch(e){return null==n||n.fail("getContext Failed"),Promise.resolve({})}},this.handleNavigateCrossDomain=function(e,t){return o.load(t)},this.handleGetAuthToken=function(e,t){var n,i,a=null===(n=o.telemetryService)||void 0===n?void 0:n.createScenario("getAuthToken",null===(i=o.appDefinition)||void 0===i?void 0:i.appId);return o.getTabContext().then(function(n){return C(e.origin,t,o.appDefinition,n).then(function(e){return o.authenticationService?o.authenticationService.acquireToken(e[0]).then(function(e){return null==a||a.stop(),[!0,e.token]}):Promise.reject("No authentication service is available")})}).catch(function(){return null==a||a.fail("GetAuthToken failed"),[!1,"GetAuthToken failed"]})},this.handleAuthenticate=function(e,t){var n,i,a=null===(n=o.telemetryService)||void 0===n?void 0:n.createScenario("authenticationAuthenticate",null===(i=o.appDefinition)||void 0===i?void 0:i.appId),r=e.data.id,s=function(e,t,n){o.frame&&o.sendResponseMessage(o.frame,r,[e,t]),e?null==a||a.stop():null==a||a.fail("auth failed with reason "+n)};o.isInFrameContext(N.a.content,N.a.sidePanel,N.a.remove,N.a.settings,N.a.task)?o.appDefinition?new U(o.hostWindow,o.hostClientType,t,s,o.appDefinition).addMessageHandler(d.getContext,o.getContext):s(!1,"App definition not available",k.AppDefinitionUnavailable):s(!1,"Authentication API not supported in "+o.frameContext+" context",k.UnsupportedFrameContext)},this.handleOpenFilePreview=function(e,t,n,i,a,r,s,u,l,d,c,f){o.appDefinition&&(o.appDefinition.isFullTrustApp||S(o.appDefinition.appId,o.appDefinition.tenantId))&&o.hostWindow.open(r)},this.getTabContext=function(){return o.contextPromise?o.contextPromise.then(function(e){return e}).catch(function(){return o.getDefaultContext()}):Promise.resolve(o.getDefaultContext())},this.urlToLoad=function(e){return e},this.handleGetUser=function(){var e,t,n=null===(e=o.telemetryService)||void 0===e?void 0:e.createScenario("getUser",null===(t=o.appDefinition)||void 0===t?void 0:t.appId);return(o.authenticationService?Promise.resolve(o.authenticationService):Promise.reject("No authentication service is available")).then(function(e){return e.getUser().then(function(e){return e?(null==n||n.stop(),[!0,e.profile]):Promise.reject("Failed to fetch the user profile")}).catch(function(){return Promise.reject("Failed to fetch the user profile")})}).catch(function(){return null==n||n.fail("GetUser failed"),[!1,"GetUser failed"]})},this.isPlaceholderInUrlPart=function(e){return e===r.teamSiteDomain||e===r.teamSitePath||e===r.glassjarBaseUrl},this.getDefaultContext=function(){return{hostClientType:o.hostClientType,frameContext:o.getFrameContext()}},this.setupMessageHandlers=function(){o.addMessageHandler(d.getContext,o.getContext),o.addMessageHandler(d.navigateCrossDomain,o.handleNavigateCrossDomain),o.addMessageHandler(d.authentication.getAuthToken,o.handleGetAuthToken),o.addMessageHandler(d.authentication.getUser,o.handleGetUser),o.addMessageHandler(d.authentication.authenticate,o.handleAuthenticate),o.addMessageHandler(d.openFilePreview,o.handleOpenFilePreview)},this.setupMessageHandlers()}return e.prototype.isInitialized=function(){return this.initialized},e.prototype.addMessageHandler=function(e,t){this.handlers[e]=t},e.prototype.setFrameAndLoadOrigin=function(e,t,n){return this.appDefinition=n,this.frame=e,this.load(t)},e.prototype.sendRequestMessage=function(e,t){if(this.origin&&this.frame){var n={func:e,args:t};this.postMessage(this.frame,n)}},e.prototype.sendResponseMessage=function(e,t,n){if(this.origin){var i={id:t,args:n,origin:this.origin};this.postMessage(e,i)}},e.prototype.getFrameContext=function(){return this.frameContext},e.prototype.setAuthenticationService=function(e){this.authenticationService=e},e.prototype.postMessageToFrame=function(e){if(!this.frame)throw new Error("could not post message, frame is not defined");this.postMessage(this.frame,e)},e.prototype.handleMessage=function(e){var t=this,n=e.data,i=this.handlers[n.func||n.name];if(i){e.sendAsyncResponse=function(e){t.sendRequestMessage(e.func,e.args)},e.postMessageToFrame=function(e){t.postMessageToFrame(e)};var a=n.args;(a=n.args&&Array.isArray(n.args)?Object(g.cloneDeep)(n.args):[]).unshift(e);var o=i.apply(this,a);if(o){var r=function(e){t.processHandlerResultHelper(n,e)};"object"==typeof o&&"then"in o&&"function"==typeof o.then?o.then(r):r(o)}}},e.prototype.load=function(e){var t=this;return this.getTabContext().then(function(n){if(T(t.appDefinition,e,n)&&t.frame){var i=t.formatTabUrl(e,n);return t.origin=i,t.frame.src=w(t.urlToLoad(i)),Promise.resolve()}return Promise.reject("Url is invalid")})},e.prototype.formatTabUrl=function(e,t){if(t)for(var n in t)if(t.hasOwnProperty(n)){var i=new RegExp("{"+n+"}","g");e=this.isPlaceholderInUrlPart(n)?e.replace(i,t[n]):e.replace(i,encodeURIComponent(t[n]))}return e},e.prototype.processHandlerResultHelper=function(e,t){var n,i,a=e.id;if("object"==typeof t&&"target"in t){var o=t;n=o.target,i=o.args,void 0!==o.id&&null!==o.id&&(a=o.id)}else n=this.frame,i=Array.isArray(t)?t:[t];n&&this.sendResponseMessage(n,a,i)},e.prototype.isInFrameContext=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.getFrameContext();if(n&&e)for(var i in e)if(n===e[i])return!0;return!1},e}(),x=function(e){function t(t,n,i,a){var o=e.call(this,t,n,i,a)||this;return o.onMessageReceived=function(e){if("webview-to-main-renderer-postmessage"===(e&&e.channel)){var t=e.target;if(o.frame===t){var n=e.args&&e.args[0];if(n){var i=e.args[1];n!==o.origin&&T(o.appDefinition,n)&&(o.origin=n),o.origin===n&&(i&&"iframeLoaded"===i.func||o.handleMessage({origin:n,data:i}))}}}},o.postMessage=function(e,t){e.send("main-renderer-to-webview-postmessage",t)},o.urlToLoad=function(e){return"https://teams.microsoft.com/iframe-container.html#iframeurl="+encodeURIComponent(e)+"&skipDomainValidation=true&multiwindow=true"},o}return Object(a.__extends)(t,e),t.prototype.setFrameAndLoadOrigin=function(t,n,i){return this.webviewEventListener=new E(t),this.webviewEventListener.addListener("ipc-message",this.onMessageReceived),e.prototype.setFrameAndLoadOrigin.call(this,t,n,i)},t}(I),P=function(e){function t(t,n,i,a){var o=e.call(this,t,n,i,a)||this;return o.onMessageReceived=function(e){if(o.frame&&o.frame.contentWindow===e.source){var t=e.origin;t!==o.origin&&T(o.appDefinition,t)&&(o.origin=e.origin),o.origin===t&&o.handleMessage(e)}},o.postMessage=function(e,t){o.origin&&(o.hostClientType===N.b.desktop?o.hostWindow.proxyPostMessage(e,t,o.origin):e.contentWindow&&e.contentWindow.postMessage(t,o.origin))},o.hostEventListener=new E(t),o.hostEventListener.addListener("message",o.onMessageReceived),o}return Object(a.__extends)(t,e),t}(I);n.d(t,"a",function(){return _});var _=function(e){var t,n,i,r=(t=e.hostWindow,n=e.hostType,i=e.frameContext,o.useMemo(function(){return n===b.a.webview?new x(t,N.b.desktop,i):new P(t,N.b.web,i)},[t,n,i]));return r.setAuthenticationService(e.authenticationService),r.initializeAuthenticationContext(e.appContext),r.addMessageHandler(d.initialize,r.initialize),e.messageHandlers&&Object(g.each)(e.messageHandlers,function(e){r&&r.addMessageHandler(e.messageName,e.handler)}),e.hostType===b.a.webview?o.createElement(h,Object(a.__assign)({},e,{sdkHost:r})):o.createElement(m,Object(a.__assign)({},e,{sdkHost:r}))}}}]);