/*Copyright (c) 2021 ksoft http://www.dummysoftware.com*/function onInitialize(){var r=document.querySelector("#interval");chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t,n,c,i=e[0],o=getOptions(i);null!=o&&r&&(t=o.interval,e=document.querySelector("#chkRandom"),1==o.isRandom?(t=o.random+"?",e.checked=!0):e.checked=!1,r.value=t,r.select(),t=document.querySelector("#status"),1==o.refresh?t.innerHTML="ON":t.innerHTML="OFF",1==o.isDomain&&(document.querySelector("#chkDomain").checked=!0),1==o.isCache&&(document.querySelector("#chkCache").checked=!0),1==o.isTimer&&(document.querySelector("#chkTimer").checked=!0),1==o.isAllTabs&&(document.querySelector("#chkAllTabs").checked=!0),n=document.querySelector("#lblLastRefresh"),c=document.querySelector("#lblNextRefresh"),isRegistered()&&null!=o.lastRefresh?(n.innerHTML=o.lastRefresh,c.innerHTML=o.nextRefresh):(n.innerHTML="n/a",c.innerHTML="n/a"),1==o.isAutoClick&&(document.querySelector("#chkAutoClick").checked=!0,document.querySelector("#autoClickDiv").style.maxHeight="60px",document.querySelector("#autoClickDiv").classList.add("visible")),document.querySelector("#txtAutoClickId").value=o.autoClickId,document.querySelector("#txtAutoClickIdStatus").setAttribute("data-valid",o.autoClickIdValid),1==o.isAutoClickAfterRefresh?document.querySelector("#chkClickAfterRefresh").checked=!0:document.querySelector("#lblAutoClickDelay").classList.add("disabled"),document.querySelector("#txtAutoClickDelay").value=o.autoClickDelay||"",document.querySelector("#txtAutoClickDelay").disabled=!o.isAutoClickAfterRefresh,1==o.isNotify&&(document.querySelector("#chkNotify").checked=!0,document.querySelector("#notifyDiv").style.maxHeight="100px",document.querySelector("#notifyDiv").classList.add("visible")),document.querySelector("#txtNotifyText").value=o.notifyText,document.querySelector("#txtNotifySound").value=o.notifySound,document.querySelector("#txtNotifyDelay").value=o.notifyDelay||"",1==o.isNotifyStop&&(document.querySelector("#chkNotifyStop").checked=!0),1==o.isNotifyNotFound&&(document.querySelector("#chkNotifyNotFound").checked=!0,document.getElementById("lblNotifyOperation").innerText="NOT found"),1==o.isUrlList&&(document.querySelector("#chkUrlList").checked=!0,document.querySelector("#urlListDiv").style.maxHeight="125px",document.querySelector("#urlListDiv").classList.add("visible")),document.querySelector("#txtUrlList").value=o.urlList?o.urlList.join("\n"):"",1==o.isTimeList&&(document.querySelector("#chkTimeList").checked=!0,document.querySelector("#timeListDiv").style.maxHeight="100px",document.querySelector("#timeListDiv").classList.add("visible")),document.querySelector("#txtTimeList").value=o.timeList?o.timeList.join("\n"):"",isRegistered()&&chrome.runtime.onMessage.addListener(function(e,t,o){e.tabId==i.id&&("updateLastRefresh"==e.message?(n.innerHTML=e.lastRefresh,c.innerHTML=e.nextRefresh):"updateRandomInterval"==e.message?r.value=e.value+"?":"updateTimeInterval"==e.message&&(r.value=e.value))}));o=document.querySelector("#lblDomain");o&&(o.innerHTML=getDomain(i.url))}),r&&(r.removeEventListener("keydown",ptuBu),r.addEventListener("keydown",ptuBu),CfQNn())}function ptuBu(e){46==e.keyCode||8==e.keyCode||9==e.keyCode||35<=e.keyCode&&e.keyCode<=40||(e.keyCode<48||57<e.keyCode)&&(e.keyCode<96||105<e.keyCode)&&e.preventDefault()}function CfQNn(){document.querySelector("#interval").select();var e=document.querySelector("#imgLock");e.removeEventListener("click",onLockClick),e.addEventListener("click",onLockClick);dataSync();e=document.querySelector("#advancedOptionsDiv");e.removeEventListener("click",XLhZs),e.addEventListener("click",XLhZs);e=document.querySelector("#txtCode");e&&(e.removeEventListener("keypress",eYnVg),e.addEventListener("keypress",eYnVg));e=document.querySelector("#btnStart");e.removeEventListener("click",bBITs),e.addEventListener("click",bBITs);e=document.querySelector("#btnStop");e.removeEventListener("click",Rpgzp),e.addEventListener("click",Rpgzp);e=document.querySelector("#chkDomain");e.removeEventListener("click",XLPpL),e.addEventListener("click",XLPpL);e=document.querySelector("#chkRandom");e.removeEventListener("click",ShVxK),e.addEventListener("click",ShVxK);e=document.querySelector("#chkCache");e.removeEventListener("click",IYUsD),e.addEventListener("click",IYUsD);e=document.querySelector("#chkTimer");e.removeEventListener("click",IYUsD),e.addEventListener("click",IYUsD);e=document.querySelector("#chkAllTabs");e.removeEventListener("click",IYUsD),e.addEventListener("click",IYUsD);e=document.querySelector("#btnRegister");e&&(e.removeEventListener("click",validateRegistrationCode),e.addEventListener("click",validateRegistrationCode));e=document.querySelector("#chkAutoClick");e.removeEventListener("click",Xbmwg),e.addEventListener("click",Xbmwg);e=document.querySelector("#txtAutoClickId");e.removeEventListener("keyup",FhxgY),e.addEventListener("keyup",FhxgY),e.removeEventListener("paste",FhxgY),e.addEventListener("paste",FhxgY),txtAutoClickDelay.removeEventListener("keyup",IYUsD),txtAutoClickDelay.addEventListener("keyup",IYUsD);e=document.querySelector("#btnGetPath");e.removeEventListener("click",onGetPath),e.addEventListener("click",onGetPath);e=document.querySelector("#chkClickAfterRefresh");e.removeEventListener("click",onClickAfterRefresh),e.addEventListener("click",onClickAfterRefresh);e=document.querySelector("#chkNotify");e.removeEventListener("click",bIPCk),e.addEventListener("click",bIPCk);e=document.querySelector("#txtNotifyText");e.removeEventListener("keyup",IYUsD),e.addEventListener("keyup",IYUsD),e.removeEventListener("paste",IYUsD),e.addEventListener("paste",IYUsD),txtNotifyDelay.removeEventListener("keyup",IYUsD),txtNotifyDelay.addEventListener("keyup",IYUsD);e=document.querySelector("#txtNotifySound");e.removeEventListener("keyup",IYUsD),e.addEventListener("keyup",IYUsD),e.removeEventListener("paste",IYUsD),e.addEventListener("paste",IYUsD);e=document.querySelector("#btnPlaySound");e.removeEventListener("click",onPlaySound),e.addEventListener("click",onPlaySound);e=document.querySelector("#chkNotifyStop");e.removeEventListener("click",IYUsD),e.addEventListener("click",IYUsD);e=document.querySelector("#chkNotifyNotFound");e.removeEventListener("click",bIPCkNotFound),e.addEventListener("click",bIPCkNotFound);e=document.querySelector("#chkUrlList");e.removeEventListener("click",GQxij),e.addEventListener("click",GQxij);e=document.querySelector("#txtUrlList");e.removeEventListener("keyup",IYUsD),e.addEventListener("keyup",IYUsD),e.removeEventListener("paste",IYUsD),e.addEventListener("paste",IYUsD);e=document.querySelector("#chkTimeList");e.removeEventListener("click",onChkTimeList),e.addEventListener("click",onChkTimeList);e=document.querySelector("#txtTimeList");e.removeEventListener("keyup",IYUsD),e.addEventListener("keyup",IYUsD),e.removeEventListener("paste",IYUsD),e.addEventListener("paste",IYUsD)}function XLhZs(){var e=document.querySelector("#advancedOptions"),t=document.querySelector("#imgAdvancedOptions");e.style.maxHeight&&"0px"!=e.style.maxHeight?t.style.backgroundPosition="0px 0px":(t.style.backgroundPosition="-15px 0px",OXsiS()),slide(e,advancedOptionsSlideHeight)}function eYnVg(e){13==e.keyCode&&document.querySelector("#btnRegister").click()}function Xbmwg(){slide(document.querySelector("#autoClickDiv"),"60px"),document.querySelector("#txtAutoClickId").focus(),FhxgY()}function onClickAfterRefresh(){var e=document.querySelector("#chkClickAfterRefresh").checked;document.querySelector("#txtAutoClickDelay").disabled=!e,e?document.querySelector("#lblAutoClickDelay").classList.remove("disabled"):document.querySelector("#lblAutoClickDelay").classList.add("disabled"),IYUsD()}function bIPCk(){slide(document.querySelector("#notifyDiv"),"100px"),document.querySelector("#txtNotifyText").focus(),IYUsD()}function bIPCkNotFound(e){document.getElementById("lblNotifyOperation").innerText=e.target.checked?"NOT found":"found",IYUsD()}function GQxij(){slide(document.querySelector("#urlListDiv"),"125px"),document.querySelector("#txtUrlList").focus(),IYUsD()}function onChkTimeList(){slide(document.querySelector("#timeListDiv"),"100px"),document.querySelector("#txtTimeList").focus(),IYUsD()}function onPlaySound(){var e=new Audio;e.src=document.querySelector("#txtNotifySound").value,e.play()}function bBITs(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],e=getOptions(t);e.interval=document.querySelector("#interval").value,e.refresh=!0,updateOptions(t,e=zJzSR(e)),chrome.extension.sendRequest({tab:t,refresh:e.refresh},function(e){}),window.close()})}function Rpgzp(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],e={};e.interval=document.querySelector("#interval").value,e.refresh=!1,updateOptions(t,e=zJzSR(e)),chrome.extension.sendRequest({tab:t,refresh:e.refresh},function(e){}),window.close()})}function ShVxK(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],o=document.querySelector("#interval");0==document.querySelector("#chkRandom").checked?o.value=o.value.replace(/\?/g,""):o.value=o.value+"?";e=getOptions(t);e.interval=o.value,updateOptions(t,e=zJzSR(e))})}function XLPpL(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0];document.querySelector("#chkDomain").checked?((e=getOptions(t)).interval=document.querySelector("#interval").value,e=zJzSR(e),updateOptions(t,localStorage[getDomain(t.url)]=e)):localStorage.removeItem(getDomain(t.url))})}function IYUsD(){validateForm()&&chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0],e=getOptions(t);e.interval=document.querySelector("#interval").value,updateOptions(t,e=zJzSR(e))})}function FhxgY(){OXsiS(function(){IYUsD()})}function OXsiS(o){var n=document.querySelector("#txtAutoClickIdStatus"),c=document.querySelector("#txtAutoClickId"),i=c.value;null!=i&&0<i.length?chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0];chrome.tabs.executeScript(t.id,{file:"scripts/content.js"},function(e){chrome.tabs.sendMessage(t.id,{action:"getAutoClickIdStatus"+i},function(e){c.style.marginTop="",c.style.marginRight="",void 0!==e&&"OK"==e.result?(n.innerHTML="<img src='/images/green-check.png' alt='OK' title='OK'>",n.setAttribute("data-valid","1"),c.style.border="2px solid #00cc00"):(n.innerHTML="<img src='/images/red-x.png' alt='Invalid selector or control not found in page' title='Control not found in page'>",n.setAttribute("data-valid","0"),c.style.border="2px solid #ff0000"),o&&o()})})}):(n.innerHTML="",n.setAttribute("data-valid","0"),c.style.border="1px solid black",c.style.marginTop="1px",c.style.marginRight="2px",o&&o())}function onGetPath(){chrome.tabs.query({active:!0,currentWindow:!0},function(e){var t=e[0];chrome.tabs.executeScript(t.id,{file:"scripts/content.js"},function(){chrome.tabs.sendMessage(t.id,{action:"getPath"+t.id},function(){alert("Select an element on the web page to auto-click.")})})})}function zJzSR(e){return e.isRandom=document.querySelector("#chkRandom").checked,e.random=e.interval,e.isDomain=document.querySelector("#chkDomain").checked,e.isCache=document.querySelector("#chkCache").checked,e.isTimer=document.querySelector("#chkTimer").checked,e.isAllTabs=document.querySelector("#chkAllTabs").checked,e.isAutoClick=document.querySelector("#chkAutoClick").checked,e.autoClickId=document.querySelector("#txtAutoClickId").value,e.autoClickIdValid=document.querySelector("#txtAutoClickIdStatus").getAttribute("data-valid"),e.isAutoClickAfterRefresh=document.querySelector("#chkClickAfterRefresh").checked,e.autoClickDelay=parseInt(document.querySelector("#txtAutoClickDelay").value)||null,e.isNotify=document.querySelector("#chkNotify").checked,e.notifyText=document.querySelector("#txtNotifyText").value,e.notifySound=document.querySelector("#txtNotifySound").value,e.notifyDelay=parseInt(document.querySelector("#txtNotifyDelay").value)||null,e.isNotifyStop=document.querySelector("#chkNotifyStop").checked,e.isNotifyNotFound=document.querySelector("#chkNotifyNotFound").checked,e.isUrlList=document.querySelector("#chkUrlList").checked,e.urlList=cleanUrlArray(document.querySelector("#txtUrlList").value.match(/.+/g)),e.isTimeList=document.querySelector("#chkTimeList").checked,e.timeList=cleanTimeArray(document.querySelector("#txtTimeList").value.match(/.+/g)),e}function updateOptions(e,t){return t.interval=t.interval.replace(/\?/g,""),t.random=t.random.replace(/\?/g,""),saveOptions(e,t),t}