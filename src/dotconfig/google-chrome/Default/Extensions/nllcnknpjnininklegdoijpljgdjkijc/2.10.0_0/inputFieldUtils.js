export function getTextBoundingRect(t,e,n,r){if(!t||!("value"in t))return t;if("string"==typeof e&&(e=parseFloat(e)),("number"!=typeof e||isNaN(e))&&(e=0),e=e<0?0:Math.min(t.value.length,e),"string"==typeof n&&(n=parseFloat(n)),("number"!=typeof n||isNaN(n)||n<e)&&(n=e),n=n<0?0:Math.min(t.value.length,n),"function"==typeof t.createTextRange){var o=t.createTextRange();return o.collapse(!0),o.moveStart("character",e),o.moveEnd("character",n-e),o.getBoundingClientRect()}var i=function(){var e=document.body,n=document.defaultView,r=document.documentElement,o=document.createElement("div");o.style.paddingLeft=o.style.width="1px",e.appendChild(o);var i=2==o.offsetWidth;e.removeChild(o),o=t.getBoundingClientRect();var a=r.clientTop||e.clientTop||0,d=r.clientLeft||e.clientLeft||0,l=n.pageYOffset||i&&r.scrollTop||e.scrollTop,p=n.pageXOffset||i&&r.scrollLeft||e.scrollLeft;return{top:o.top+l-a,left:o.left+p-d}}(),a=i.top,d=i.left,l=x("width",!0),p=x("height",!0);"border-box"===x("box-sizing")&&(l-=x("border-left-width",!0)+x("padding-left",!0)+x("padding-right",!0)+x("border-right-width",!0),p-=x("border-top-width",!0)+x("padding-top",!0)+x("padding-bottom",!0)+x("border-bottom-width",!0));var c="white-space:pre;padding:0;margin:0;",s=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing","white-space"];a+=x("padding-top",!0),a+=x("border-top-width",!0),d+=x("padding-left",!0),d+=x("border-left-width",!0),d+=1;for(var f=0;f<s.length;f++){var g=s[f];c+=g+":"+x(g)+";"}var u=t.value,h=u.length,m=document.createElement("div");e>0&&w(0,e);var v=w(e,n);h>n&&w(n,h),m.style.cssText=c,m.style.position="absolute",m.style.top=a+"px",m.style.left=d+"px",m.style.width=l+"px",m.style.height=p+"px",document.body.appendChild(m);var y=v.getBoundingClientRect(),b=v.getClientRects();return r||m.parentNode.removeChild(m),{rect:y,rects:b,range:v};function w(t,e){var n=document.createElement("span");return n.style.cssText=c,n.textContent=u.substring(t,e),m.appendChild(n),n}function x(e,n){var r=document.defaultView.getComputedStyle(t,null).getPropertyValue(e);return n?parseFloat(r):r}}